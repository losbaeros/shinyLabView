---
title: "ShinyLabView"
output: 
  flexdashboard::flex_dashboard:
runtime: shiny
---

```{r global, include=FALSE}
library(data.table)
library(DT)
library(lubridate)
labData <- read.csv("./dummyValues.csv") # loading labData in global needs to be done only once.
```

Inputs {.sidebar}
-----------------------------------------------------------------------
```{r}
selectInput("patId", label = "Patient ID",
            choices = labData$patientId)
```

Column
-----------------------------------------------------------------------
```{r}
labData$date <- as_datetime(labData$date) # convert unixTs to human readable string
displayData <- reactive({ # build a reactive component
  displayData <- labData[labData$patientId == input$patId, ] # select by patientId
  displayData <- displayData[order(displayData$date, decreasing = TRUE), ] # sort by date
  displayData <- subset(displayData, select = c(date, na, k, krea, hst, gfr, hgb, rbc, plt, wbc, inr, ptt)) # select Values to display
})

DT::renderDataTable( # see: https://rstudio.github.io/DT/options.html & https://rstudio.github.io/DT/shiny.html
  datatable( # I'm using a seperate datatable-obj. to enable formatRounding.
    data = displayData(),
    rownames = FALSE
  )
  %>% formatRound(c(2:22), 2) # see: https://stackoverflow.com/questions/33171279/dt-in-shiny-and-r-custom-number-formatting
)
```
